(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a5221afe"],{5260:function(t,e,i){},e3de:function(t,e,i){"use strict";i("5260")},f523:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("div",{staticClass:"specification"},[i("ul",{staticClass:"spec-list"},[i("Container",{on:{drop:function(e){return t.onDrop(e)}}},t._l(t.specification,(function(e,n){return i("Draggable",{key:n},[i("li",{staticClass:"item"},[i("div",{staticClass:"name"},[i("el-input",{staticStyle:{width:"300px",float:"left"},attrs:{size:"default",placeholder:"输入产品规格"},model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"item.name"}}),i("i",{staticClass:"el-icon-circle-close",on:{click:function(e){return t.delSpec(n)}}})],1),i("div",{staticClass:"values"},[i("Container",{staticStyle:{display:"inline-block"},attrs:{orientation:"horizontal",tag:"span"},on:{drop:function(i){return t.onInnerDrop(e,i)}}},t._l(e.items,(function(e,s){return i("Draggable",{key:s,staticStyle:{display:"inline-block"},attrs:{tag:"span"}},[i("span",{staticClass:"tag"},[i("span",{staticClass:"select__tags-text"},[t._v(t._s(e.name))]),i("a-icon",{attrs:{type:"close"},on:{click:function(e){return t.delSpecTag(n,s)}}})],1)])})),1),i("div",{staticClass:"add-attr"},[i("el-input",{attrs:{size:"small",placeholder:"回车添加商品属性"},on:{pressEnter:function(i){return t.addSpecTag(i,n,e.items.length)}},model:{value:t.specValue[n],callback:function(e){t.$set(t.specValue,n,e)},expression:"specValue[index]"}})],1)],1)])])})),1)],1),i("div",{staticClass:"add-spec"},[i("el-button",{attrs:{size:"default",disabled:t.specification.length>=15},on:{click:t.addSpec}},[t._v("添加规格项目")])],1)]),i("div",{staticClass:"example"},[i("table",{staticClass:"stock-table",attrs:{cellspacing:"0",cellpadding:"0"}},[i("thead",[i("tr",[t._l(t.specification,(function(e,n){return i("th",{key:n},[t._v(" "+t._s(e.name)+" ")])})),i("th",[t._v("图片")]),i("th",[t._v("销售价")]),i("th",[t._v("建议零售价")]),i("th",[t._v("库存")]),i("th",[t._v("UPC码")]),i("th",[t._v("69码")]),i("th",[t._v("重量(克)")])],2)]),t.specification[0]&&t.specification[0].items.length?i("tbody",[t._l(t.childProductArray,(function(e,n){return i("tr",{key:e.childProductId||e.skuId},[t._l(t.specification.length,(function(e,s){return[t.showTd(s,n)?i("td",{key:e,attrs:{rowspan:t.countSum(e)}},[t._v(" "+t._s(t.getSpecAttr(s,n,"name"))+" ")]):t._e()]})),i("td"),i("td",[i("el-input",{attrs:{size:"small",type:"text",placeholder:"输入销售价"},model:{value:e.goodsPrice,callback:function(i){t.$set(e,"goodsPrice",t._n(i))},expression:"item.goodsPrice"}})],1),i("td",[i("el-input",{attrs:{size:"small",type:"text",placeholder:"建议零售价"},model:{value:e.marketPrice,callback:function(i){t.$set(e,"marketPrice",t._n(i))},expression:"item.marketPrice"}})],1),i("td",[i("el-input",{attrs:{size:"small",type:"text",placeholder:"输入库存"},model:{value:e.goodsNumber,callback:function(i){t.$set(e,"goodsNumber",t._n(i))},expression:"item.goodsNumber"}})],1),i("td",[i("el-input",{attrs:{size:"small",type:"text",placeholder:"输入UPC码"},model:{value:e.goodsUpc,callback:function(i){t.$set(e,"goodsUpc",t._n(i))},expression:"item.goodsUpc"}})],1),i("td",[i("el-input",{attrs:{size:"small",type:"text",placeholder:"输入69码"},model:{value:e.goodsCode,callback:function(i){t.$set(e,"goodsCode",t._n(i))},expression:"item.goodsCode"}})],1),i("td",[i("el-input",{attrs:{size:"small",type:"text",placeholder:"输入重量"},model:{value:e.goodsWeight,callback:function(i){t.$set(e,"goodsWeight",t._n(i))},expression:"item.goodsWeight"}})],1)],2)})),i("tr",[i("td",{staticClass:"wh-foot",attrs:{colspan:"8"}},[i("span",{staticClass:"label"},[t._v("批量设置：")]),t.isSetListShow?i("ul",{staticClass:"set-list"},[i("li",{staticClass:"set-item",on:{click:function(e){return t.openBatch("goodsPrice")}}},[t._v("销售价")]),i("li",{staticClass:"set-item",on:{click:function(e){return t.openBatch("marketPrice")}}},[t._v("建议零售价")]),i("li",{staticClass:"set-item",on:{click:function(e){return t.openBatch("goodsNumber")}}},[t._v("库存")]),i("li",{staticClass:"set-item",on:{click:function(e){return t.openBatch("goodsUpc")}}},[t._v("UPC码")]),i("li",{staticClass:"set-item",on:{click:function(e){return t.openBatch("goodsCode")}}},[t._v("69码")]),i("li",{staticClass:"set-item",on:{click:function(e){return t.openBatch("goodsWeight")}}},[t._v("重量(克)")])]):i("div",{staticClass:"set-form"},[i("el-input",{attrs:{size:"small",placeholder:"输入要设置的数量"},model:{value:t.batchValue,callback:function(e){t.batchValue=t._n(e)},expression:"batchValue"}}),i("i",{staticClass:"el-icon-check",style:{color:"#0088ee"},on:{click:t.setBatch}}),i("i",{staticClass:"el-icon-close",style:{color:"#cc0000"},on:{click:t.cancelBatch}})],1)])])],2):t._e()])])])},s=[],c=(i("99af"),i("4160"),i("c975"),i("baa5"),i("d81d"),i("13d5"),i("fb6a"),i("a434"),i("b0c0"),i("b64b"),i("d3b7"),i("ac1f"),i("25f0"),i("1276"),i("159b"),i("2909")),a=(i("a15b"),function(t,e){var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");e=e||i.length;var n=[];if(t)for(var s=0;s<t;s++)n[s]=i[0|Math.random()*e];else{n[8]=n[13]=n[18]=n[23]="-",n[14]="4";for(var c=0;c<36;c++)if(!n[c]){var a=0|16*Math.random();n[c]=i[19===c?3&a|8:a]}}return n.join("")}),o=i("3f7d");var r=function(t,e){var i=e.removedIndex,n=e.addedIndex,s=e.payload;if(null===i&&null===n)return t;var a=Object(c["a"])(t),o=s;return null!==i&&(o=a.splice(i,1)[0]),null!==n&&a.splice(n,0,o),a},l={name:"NewSku",components:{Container:o["Container"],Draggable:o["Draggable"]},props:{spec:{type:[Array,Object],default:function(){}},inheritAttrs:{type:Boolean,default:!1}},data:function(){return{specification:[],specValue:[],newList:[],newData:[],childProductArray:[],oldTableData:[],isSetListShow:!0,batchValue:"",currentType:""}},computed:{value:function(){var t=this.specification,e=this.childProductArray;return{specification:t,childProductArray:e}}},watch:{value:function(t,e){this.$emit("change",t)}},created:function(){},mounted:function(){if(0!==this.spec.length){var t=this.spec.goodsSpec,e=this.spec.goodsSpec.spec;console.log(e),this.specification=e;var i=this.spec.goodsSpec.option,n=[],s=function(e){var s=i[e],c=s.name.split("+"),a=s.specs.split("_"),o=[];c.map((function(e,i){o.push({id:a[i]-0,name:t.spec[i]&&t.spec[i].name||"",items:e})})),n.push({isShow:!0,id:s.skuId,skuInfo:s,items:o})};for(var c in i)s(c);var a=[];n.map((function(t){a.push(t.skuInfo)}));var o=[],r="",l="";a.map((function(t,e){var i={},n={};t.specInfo.map((function(t){r=t.name,l=t.value,i[r]=l})),n.childProductSpec=i,o.push(Object.assign({},t,n))})),this.childProductArray=o,this.childProductArray.forEach((function(t,e){var i=t.picUnique;i=i.slice(i.lastIndexOf(".cn/")+4,i.length),t.uploadObj={url:t.picUnique,thumbUrl:t.picUnique,name:i,uid:t.picUnique,picUrl:t.picUnique,status:"done"}}))}},methods:{addSpec:function(){this.specification.length<15&&this.specification.push({name:"",specId:""+a(8,8),items:[]})},delSpec:function(t){this.specification.splice(t,1),this.processing()},addSpecTag:function(t,e,i){if(""===t.target.value)return this.$message.error("请输入内容"),!1;var n={itemId:""+a(16,16),name:""};n.name=t.target.value;var s=!1;this.specification[e].items.forEach((function(t){t.name===n.name&&(s=!0)})),s?this.$message.error("请勿添加重复子规格"):(this.specification[e].items.push(n),this.specValue[e]="",this.processing())},delSpecTag:function(t,e){this.specification[t].items.splice(e,1),this.processing()},processing:function(){var t=this;this.newData=[],console.log(this.specification);for(var e=function(e){var i=[];console.log(t.specification[e].items),t.specification[e].items.forEach((function(n,s){var c={};c[t.specification[e].name]=t.specification[e].items[s].name,i.push(c)})),t.newData.push(i)},i=0;i<this.specification.length;i++)e(i);console.log(this.newData),this.getList()},getList:function(){var t=this;this.oldTableData=this.childProductArray.length?this.childProductArray:[],this.childProductArray=[],this.newList=this.descartes(this.newData),console.log(this.newList);for(var e=function(e){var i=[];if(Array.isArray(t.newList[e]))t.newList[e].forEach((function(e,n){var s={};s["id"]=t.getSpecAttr(n,n,"id"),s["typeName"]=t.getKey(e),s["name"]=e[t.getKey(e)],i.push(s)}));else{var n={};n["id"]=t.specification[0].items[e].itemId,n["typeName"]=t.getKey(t.newList[e]),n["value"]=t.newList[e][t.getKey(t.newList[e])],i.push(n)}var s={};s["specInfo"]=i,s["name"]=t.setName(t.newList[e]),s["goodsPrice"]="",s["goodsNumber"]="",s["picUnique"]="",s["marketPrice"]="",s["goodsUpc"]="",s["goodsCode"]="",s["goodsWeight"]="",s["uploadObj"]={},s["childProductId"]=""+a(16,16),s["childProductSpec"]=t.getChildProductSpec(e),t.childProductArray.push(s)},i=0;i<this.newList.length;i++)e(i);console.log(this.oldTableData),this.oldTableData.length&&this.verification(),console.log(this.childProductArray)},getChildProductSpec:function(t){var e={},i=this;return this.specification.forEach((function(n,s){e[n.name]=i.getSpecAttr(s,t,"name")})),e},verification:function(){var t=this;this.childProductArray.forEach((function(e,i){t.oldTableData.forEach((function(n){e.name===n.name&&t.childProductArray.splice(i,1,n)}))}))},verificationName:function(t,e){var i=t.split("+"),n=!0;return i.length===e.length&&(e.forEach((function(e){if(e.items.indexOf(t)<0)return!1})),n)},getKey:function(t){return Object.keys(t)[0]},setName:function(t){var e=this,i="";return Array.isArray(t)?(t.forEach((function(n,s){s<t.length-1?i+=n[e.getKey(n)]+"+":i+=n[e.getKey(n)]})),i):t[this.getKey(t)]},descartes:function(t){return console.log(t),t.length<2||2===t.length&&0===t[1].length?t[0]||[]:[].reduce.call(t,(function(t,e){var i=[];return t.forEach((function(t){e.forEach((function(e){var n=[].concat(Array.isArray(t)?t:[t]);n.push(e),i.push(n)}))})),console.log(i),i}))},onDrop:function(t){this.specification=r(this.specification,t),this.processing()},onInnerDrop:function(t,e){var i=Object(c["a"])(this.specification),n=i.indexOf(t);i[n].items=r(i[n].items,e),this.specification=i,this.processing()},countSum:function(t){var e=1;return this.specification.forEach((function(i,n){n>=t&&i.items.length&&(e*=i.items.length)})),e},showTd:function(t,e){return!!this.specification[t]&&e%this.countSum(t+1)===0},normFile:function(t){return Array.isArray(t)?t:t&&t.fileList},childByValue:function(t,e){0!==t.length&&void 0!==t.length&&t[0].name&&(this.childProductArray[e].picUnique=t[0].name,this.childProductArray[e].url=t[0].thumbUrl,this.childProductArray[e].uploadObj=t[0])},getSpecAttr:function(t,e,i){"id"===i&&console.log(t);var n,s=this.specification[t].items;n=this.specification[t+1]&&this.specification[t+1].items.length?e/this.countSum(t+1):e;var c=Math.floor(n%s.length);return"NaN"!==c.toString()?"name"===i?s[c].name:s[c].itemId:""},openBatch:function(t){this.currentType=t,this.isSetListShow=!1},setBatch:function(){var t=this;"string"!==typeof this.batchValue?(this.childProductArray.forEach((function(e){e[t.currentType]=t.batchValue})),this.cancelBatch()):this.$message.warning("请输入正确的值")},cancelBatch:function(){this.batchValue="",this.currentType="",this.isSetListShow=!0}}},u=l,h=(i("e3de"),i("2877")),d=Object(h["a"])(u,n,s,!1,null,null,null);e["default"]=d.exports}}]);